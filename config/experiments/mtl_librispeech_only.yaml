# @package _global_

defaults:
  - override /callbacks: speaker_default
  - override /data/module: mtl_librispeech_960h
  - override /data/pipe: mtl_datapipe
  - override /network: mtl_wav2vec2_linear
  - override /optim/algo: adam
  - override /optim/schedule: tri_stage
  - override /optim/loss: mt_speech_speaker_loss
  - override /trainer: trainer_gpu

trainer:
  max_steps: 100_000
  val_check_interval: 5000
  precision: 16

network:
  freeze_cnn: true
  freeze_transformer: true  # this also freezes projector and rel. pos. emb
  num_steps_freeze_cnn: -1 # so always
  num_steps_freeze_transformer: 2_000
  speaker_head_cfg:
    use_cosine_linear: true

optim:
  algo:
    lr: 1e-4
  loss:
    use_cross_entropy: false
